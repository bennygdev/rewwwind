{% extends "dashboard/base.html" %}
{% set active_page = "manage_products" %}
{% block styles %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/pageInteractions/resizableTextArea.css') }}">
<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='css/dashboard/manageProducts/addProduct.css') }}">
{% endblock %}
{% block title %}Add Product{% endblock %}

{% block content %}
<div class="header">
    <h2>Add Product</h2>
    <a href="/dashboard/manage-products"><i class="bi bi-arrow-left"></i>&nbsp;&nbsp;<span>Back</span></a>
</div>
<div class="body">
    <form method="POST" class="product__form" enctype="multipart/form-data">
        {{ form.hidden_tag() }}


        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                {% if category == 'error' %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    There were some errors in the form. Please verify them.
                    <ol style='margin: 0;'>
                        <li>{{ message | join('') | replace("['", "") | replace("']", "") }}</li>
                    </ol>
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% elif category == 'info' %}
                <div class="alert alert-primary alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% elif category == 'success'  %}
                <div class="alert alert-success alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% endif %}
        {% endwith %}


        {{ form.productThumbnail() }}
        <div class="product__name">
            {{ form.productName.label }}
            {{ form.productName(class='form-control', placeholder='Enter product name here') }}
        </div>
        <div class="product__creator">
            {{ form.productCreator.label }}
            {{ form.productCreator(class='form-control', placeholder='Enter product creator name here') }}
        </div>
        <div class="product__images">
            <label>Product Image Upload</label>
            {{ form.productImages.label }}
            {{ form.productImages() }}
            {% if form.productImages.errors %}
                <div class="alert alert-danger alert-dismissible fade show" role="alert">
                    {% for error in form.productImages.errors %}
                        {{ error }}
                    {% endfor %}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endif %}
            <div class="file-list"></div>
        </div>
        <div class="product__description">
            {{ form.productDescription.label }}
            {{ form.productDescription(class='form-control resizable', placeholder='PLEASE BUY OUR PRODUCTS PLEASE PLEASE PLEASE') }}
        </div>
        <div class="centralise-content">
            <div class="product__type">
                {{ form.productType.label }}
                {{ form.productType(class='form-select') }}
            </div>
            <div class="product__genre">
                {{ form.productGenre.label }}
                {{ form.productGenre(class='form-select') }}
            </div>
        </div>
        <div class="product__conditions">
            {% for condition in form.productConditions %}
            <div class="centralise-content condition">
                {{ condition.condition.label }}
                {{ condition.condition(class='form-select') }}
        
                {{ condition.stock.label }}
                {{ condition.stock(class='form-control') }}
        
                {{ condition.price.label }}
                {{ condition.price(class='form-control') }}
            </div>
            {% endfor %}
            <button type="button" class="addCondition"><i class="fa-solid fa-plus"></i>&nbsp;Add Condition</button>
        </div>
        <div class="button__wrapper">
            {{ form.submit() }}
        </div>
    </form>
</div>
{% endblock %}

{% block body_scripts %}
<script src="{{ url_for('static', filename='js/pageInteractions/resizableTextArea.js') }}"></script>
<script src="{{ url_for('static', filename='js/dashboard/manageProducts/addProduct.js') }}"></script>
{% endblock %}